# Development container configuration
# Usage: make dev
#
# Mounts current directory and runs as current user.
# Use `docker compose exec av-scanner sh` to enter the container.

services:
  av-scanner:
    build:
      context: .
      dockerfile: Dockerfile.dev
    user: "${UID}:${GID}"
    working_dir: /app
    volumes:
      - .:/app
      - node_modules:/app/node_modules
    ports:
      - "${PORT:-3000}:3000"
    environment:
      - NODE_ENV=development
      - AV_ENGINE=${AV_ENGINE:-clamav}
      - CLAMAV_RTS_ENABLED=false
      - CLAMAV_SCAN_BINARY_PATH=/usr/bin/clamdscan
      - LOG_LEVEL=${LOG_LEVEL:-debug}
    command: sleep infinity

volumes:
  node_modules:
